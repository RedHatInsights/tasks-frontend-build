{"version":3,"file":"js/CompletedTaskDetails.1656431680242.509647ac3929c5266b6b.js","mappings":"iXAKMA,EAAiB,SAAC,EAA0BC,GAA3B,IAAWC,EAAX,EAAWA,aAAX,OACrB,kBAAC,EAAAC,KAAD,CACEC,IAAG,uBAAkBH,GAErBI,GAAE,KAEDH,IAILF,EAAeM,UAAY,CACzBC,GAAID,IAAAA,OACJJ,aAAcI,IAAAA,QAGT,IAAME,EAAe,CAC1BC,MAAO,cACPC,MAAO,CACLC,MAAO,IAETC,WAAY,eACZC,aAAc,SAACC,GAAD,OAASA,EAAIZ,cAC3Ba,YAAYC,EAAAA,EAAAA,IAAsBhB,IAGvBiB,EAAe,CAC1BR,MAAO,SACPC,MAAO,CACLC,MAAO,IAETC,WAAY,SACZC,aAAc,SAACC,GAAD,OAASA,EAAII,SAGhBC,EAAgB,CAC3BV,MAAO,UACPC,MAAO,CACLC,MAAO,IAETC,WAAY,UACZC,aAAc,SAACC,GAAD,OAASA,EAAIM,UAGhBC,EAAoB,CAACb,EAAcS,EAAcE,GAE9D,SAAgBX,EAAcS,EAAcE,G,eChD/BG,EAAe,CAC1BC,K,SAAMC,EAAAA,KACNC,MAAO,SACPC,OAAQ,SAACC,EAAMC,GAAP,OACND,EAAKD,QAAO,SAACZ,GAAD,OACVA,EAAIZ,aAAa2B,cAAcC,SAASF,EAAMC,oB,4nBC2JpD,QAhI6B,WAAM,MACzBtB,GAAOwB,EAAAA,EAAAA,aAAPxB,GACFyB,EAAUC,OAAOC,OAAOC,GAC9B,GACEC,EAAAA,EAAAA,UAASC,EAAAA,IADX,eAAOC,EAAP,KAA6BC,EAA7B,KAEA,GACEH,EAAAA,EAAAA,UAASI,EAAAA,IADX,eAAOC,EAAP,KAA0BC,EAA1B,KAEA,GAA0BN,EAAAA,EAAAA,YAA1B,eAAOO,EAAP,KAAcC,EAAd,KAEMC,EAAU,SAACC,GAAW,QAC1B,OAAOA,MAAAA,GAAA,UAAAA,EAAQC,gBAAR,eAAkB7B,SAAuC,OAA7B4B,MAAAA,GAAA,UAAAA,EAAQC,gBAAR,eAAkB7B,SAGjD8B,EAAY,SAACF,GACjBF,EAASE,IACTG,EAAAA,EAAAA,GAAqB,CACnBC,QAAS,SACTzC,MAAO,QACP0C,YAAaL,EAAO1B,QACpBgC,aAAa,KA6BjB,OAzBAC,EAAAA,EAAAA,YAAU,WACR,IAAMC,EAAS,mCAAG,uGACQC,EAAAA,EAAAA,IAAkBhD,GAD1B,UACZiD,EADY,QAGZX,EAAQW,GAHI,gBAIdR,EAAUQ,GAJI,wCAMSC,EAAAA,EAAAA,IAAsBlD,GAN/B,UAMRmD,EANQ,QAQVb,EAAQa,GARE,iBASZV,EAAUU,GATE,+BAWZF,EAAYG,eAAiBD,EAAShC,QAAO,SAACkC,GAC5C,MAAwB,4BAAjBA,EAAKxC,WACXyC,OACHL,EAAYM,aAAeJ,EAASG,OAdxB,UAeNtB,EAAwBiB,GAflB,yBAgBNd,EAAqBgB,GAhBf,4CAAH,qDAqBfJ,MACC,IAGD,6BACGX,EACC,kBAACoB,EAAA,EAAD,CACEC,KAAMC,EAAAA,GACNC,MAAM,UACNzD,MAAO,2BACP0D,KAAMC,EAAAA,GACNzB,MAAK,gBAAWA,MAAAA,GAAX,UAAWA,EAAOI,gBAAlB,aAAW,EAAiB7B,OAA5B,aAAuCyB,MAAAA,OAAvC,EAAuCA,EAAOvB,WAGrD,kBAAC,aAAD,KACE,kBAACiD,EAAA,EAAD,KACE,kBAAC,EAAAC,WAAD,CAAYC,OAAO,sCACjB,kBAAC,EAAAC,eAAD,CAAgBnE,GAAG,iCAAnB,SAGA,kBAAC,EAAAmE,eAAD,CAAgBC,UAAQ,GACrBnC,EAAqBoC,aAG1B,kBAAC,EAAAC,KAAD,CAAMC,UAAW,CAAEC,QAAS,SAAUC,GAAI,QACxC,kBAAC,EAAAH,KAAD,CACEC,UAAW,CAAEC,QAAS,UACtBE,KAAM,CAAEF,QAAS,WAEjB,kBAAC,EAAAG,SAAD,KACE,kBAACC,EAAA,EAAD,CAAiBxE,MAAO6B,EAAqBoC,cAE/C,kBAAC,EAAAM,SAAD,KAAW1C,EAAqBa,cAElC,kBAAC+B,EAAA,EAAD,CACEC,KAAM7C,EACN8C,aAAcC,EAAAA,GACdC,UAAWC,EAAAA,OAIjB,kBAACC,EAAA,EAAD,KACE,kBAAC,EAAAC,KAAD,KACE,kBAAC,EAAAd,KAAD,CACEe,UAAU,qCACVC,eAAgB,CAAEd,QAAS,8BAC3BD,UAAW,CAAEC,QAAS,SAAUC,GAAI,QAEpC,kBAACI,EAAA,EAAD,CACEC,KAAM7C,EACN8C,aAAcQ,EAAAA,GACdN,UAAWO,EAAAA,OAIjB,6BACA,kBAAC,EAAAJ,KAAD,KACE,kBAACK,EAAA,EAAD,CACErE,MAAK,UAAKa,EAAqB/B,GAA1B,mBACLgE,OAAM,UAAKjC,EAAqB/B,GAA1B,yBACNwF,QAASA,EACTC,MAAOvD,EACPT,QAAS,CACPiE,aAAcjE,GAEhBkE,QAAO,OACFC,EAAAA,IADE,IAELC,WAAY,EAAF,KACLD,EAAAA,GAAAA,YADK,IAERJ,QAAS1E,MAGbgF,WAAWA,EAAAA,EAAAA,GAAU,QACrBC,gBAAc","sources":["webpack:///./src/SmartComponents/CompletedTaskDetails/Columns.js","webpack:///./src/SmartComponents/CompletedTaskDetails/Filters.js","webpack:///./src/SmartComponents/CompletedTaskDetails/CompletedTaskDetails.js"],"sourcesContent":["import React from 'react';\nimport propTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport { renderColumnComponent } from '../../Utilities/helpers';\n\nconst SystemNameCell = ({ /*id,*/ display_name }, index) => (\n  <Link\n    key={`system-title-${index}`}\n    //to={`/executed/${id}`}\n    to={`/`}\n  >\n    {display_name}\n  </Link>\n);\n\nSystemNameCell.propTypes = {\n  id: propTypes.string,\n  display_name: propTypes.string,\n};\n\nexport const SystemColumn = {\n  title: 'System name',\n  props: {\n    width: 35,\n  },\n  sortByProp: 'display_name',\n  renderExport: (job) => job.display_name,\n  renderFunc: renderColumnComponent(SystemNameCell),\n};\n\nexport const ResultColumn = {\n  title: 'Result',\n  props: {\n    width: 20,\n  },\n  sortByProp: 'status',\n  renderExport: (job) => job.status,\n};\n\nexport const MessageColumn = {\n  title: 'Message',\n  props: {\n    width: 20,\n  },\n  sortByProp: 'message',\n  renderExport: (job) => job.message,\n};\n\nexport const exportableColumns = [SystemColumn, ResultColumn, MessageColumn];\n\nexport default [SystemColumn, ResultColumn, MessageColumn];\n","import { conditionalFilterType } from '@redhat-cloud-services/frontend-components/ConditionalFilter';\n\nexport const systemFilter = {\n  type: conditionalFilterType.text,\n  label: 'System',\n  filter: (jobs, value) =>\n    jobs.filter((job) =>\n      job.display_name.toLowerCase().includes(value.toLowerCase())\n    ),\n};\n","import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport TasksTables from '../../Utilities/hooks/useTableTools/Components/TasksTables';\nimport { Main } from '@redhat-cloud-services/frontend-components/Main';\nimport {\n  PageHeader,\n  PageHeaderTitle,\n} from '@redhat-cloud-services/frontend-components/PageHeader';\nimport {\n  Breadcrumb,\n  BreadcrumbItem,\n  Card,\n  Flex,\n  FlexItem,\n} from '@patternfly/react-core';\nimport { ExclamationCircleIcon } from '@patternfly/react-icons';\nimport columns, { exportableColumns } from './Columns';\nimport { fetchExecutedTask, fetchExecutedTaskJobs } from '../../../api';\nimport * as Filters from './Filters';\nimport {\n  COMPLETED_INFO_PANEL,\n  COMPLETED_INFO_PANEL_FLEX_PROPS,\n  COMPLETED_INFO_BUTTONS,\n  COMPLETED_INFO_BUTTONS_FLEX_PROPS,\n  LOADING_INFO_PANEL,\n  LOADING_JOBS_TABLE,\n  TASK_ERROR,\n  TASKS_TABLE_DEFAULTS,\n} from '../../constants';\nimport FlexibleFlex from '../../PresentationalComponents/FlexibleFlex/FlexibleFlex';\nimport EmptyStateDisplay from '../../PresentationalComponents/EmptyStateDisplay/EmptyStateDisplay';\nimport { emptyRows } from '../../PresentationalComponents/NoResultsTable/NoResultsTable';\nimport { dispatchNotification } from '../../Utilities/Dispatcher';\n\nconst CompletedTaskDetails = () => {\n  const { id } = useParams();\n  const filters = Object.values(Filters);\n  const [completedTaskDetails, setCompletedTaskDetails] =\n    useState(LOADING_INFO_PANEL);\n  const [completedTaskJobs, setCompletedTaskJobs] =\n    useState(LOADING_JOBS_TABLE);\n  const [error, setError] = useState();\n\n  const isError = (result) => {\n    return result?.response?.status && result?.response?.status !== 200;\n  };\n\n  const setErrors = (result) => {\n    setError(result);\n    dispatchNotification({\n      variant: 'danger',\n      title: 'Error',\n      description: result.message,\n      dismissable: true,\n    });\n  };\n\n  useEffect(() => {\n    const fetchData = async () => {\n      let taskDetails = await fetchExecutedTask(id);\n\n      if (isError(taskDetails)) {\n        setErrors(taskDetails);\n      } else {\n        const taskJobs = await fetchExecutedTaskJobs(id);\n\n        if (isError(taskJobs)) {\n          setErrors(taskJobs);\n        } else {\n          taskDetails.messages_count = taskJobs.filter((item) => {\n            return item.message !== 'No vulnerability found.';\n          }).length;\n          taskDetails.system_count = taskJobs.length;\n          await setCompletedTaskDetails(taskDetails);\n          await setCompletedTaskJobs(taskJobs);\n        }\n      }\n    };\n\n    fetchData();\n  }, []);\n\n  return (\n    <div>\n      {error ? (\n        <EmptyStateDisplay\n          icon={ExclamationCircleIcon}\n          color=\"#c9190b\"\n          title={'Task cannot be displayed'}\n          text={TASK_ERROR}\n          error={`Error ${error?.response?.status}: ${error?.message}`}\n        />\n      ) : (\n        <React.Fragment>\n          <PageHeader>\n            <Breadcrumb ouiaId=\"completed-tasks-details-breadcrumb\">\n              <BreadcrumbItem to=\"/beta/insights/tasks/executed\">\n                Tasks\n              </BreadcrumbItem>\n              <BreadcrumbItem isActive>\n                {completedTaskDetails.task_title}\n              </BreadcrumbItem>\n            </Breadcrumb>\n            <Flex direction={{ default: 'column', md: 'row' }}>\n              <Flex\n                direction={{ default: 'column' }}\n                flex={{ default: 'flex_1' }}\n              >\n                <FlexItem>\n                  <PageHeaderTitle title={completedTaskDetails.task_title} />\n                </FlexItem>\n                <FlexItem>{completedTaskDetails.description}</FlexItem>\n              </Flex>\n              <FlexibleFlex\n                data={completedTaskDetails}\n                flexContents={COMPLETED_INFO_BUTTONS}\n                flexProps={COMPLETED_INFO_BUTTONS_FLEX_PROPS}\n              />\n            </Flex>\n          </PageHeader>\n          <Main>\n            <Card>\n              <Flex\n                className=\"completed-task-details-info-border\"\n                justifyContent={{ default: 'justifyContentSpaceBetween' }}\n                direction={{ default: 'column', md: 'row' }}\n              >\n                <FlexibleFlex\n                  data={completedTaskDetails}\n                  flexContents={COMPLETED_INFO_PANEL}\n                  flexProps={COMPLETED_INFO_PANEL_FLEX_PROPS}\n                />\n              </Flex>\n            </Card>\n            <br />\n            <Card>\n              <TasksTables\n                label={`${completedTaskDetails.id}-completed-jobs`}\n                ouiaId={`${completedTaskDetails.id}-completed-jobs-table`}\n                columns={columns}\n                items={completedTaskJobs}\n                filters={{\n                  filterConfig: filters,\n                }}\n                options={{\n                  ...TASKS_TABLE_DEFAULTS,\n                  exportable: {\n                    ...TASKS_TABLE_DEFAULTS.exportable,\n                    columns: exportableColumns,\n                  },\n                }}\n                emptyRows={emptyRows('jobs')}\n                isStickyHeader\n              />\n            </Card>\n          </Main>\n        </React.Fragment>\n      )}\n    </div>\n  );\n};\n\nexport default CompletedTaskDetails;\n"],"names":["SystemNameCell","index","display_name","Link","key","to","propTypes","id","SystemColumn","title","props","width","sortByProp","renderExport","job","renderFunc","renderColumnComponent","ResultColumn","status","MessageColumn","message","exportableColumns","systemFilter","type","conditionalFilterType","label","filter","jobs","value","toLowerCase","includes","useParams","filters","Object","values","Filters","useState","LOADING_INFO_PANEL","completedTaskDetails","setCompletedTaskDetails","LOADING_JOBS_TABLE","completedTaskJobs","setCompletedTaskJobs","error","setError","isError","result","response","setErrors","dispatchNotification","variant","description","dismissable","useEffect","fetchData","fetchExecutedTask","taskDetails","fetchExecutedTaskJobs","taskJobs","messages_count","item","length","system_count","EmptyStateDisplay","icon","ExclamationCircleIcon","color","text","TASK_ERROR","PageHeader","Breadcrumb","ouiaId","BreadcrumbItem","isActive","task_title","Flex","direction","default","md","flex","FlexItem","PageHeaderTitle","FlexibleFlex","data","flexContents","COMPLETED_INFO_BUTTONS","flexProps","COMPLETED_INFO_BUTTONS_FLEX_PROPS","Main","Card","className","justifyContent","COMPLETED_INFO_PANEL","COMPLETED_INFO_PANEL_FLEX_PROPS","TasksTables","columns","items","filterConfig","options","TASKS_TABLE_DEFAULTS","exportable","emptyRows","isStickyHeader"],"sourceRoot":""}